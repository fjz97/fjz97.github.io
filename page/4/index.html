<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="feng's blog"><meta name="keywords" content=""><meta name="author" content="feng"><meta name="copyright" content="feng"><title>Make noise since 1997. | 冯京哲的狗窝</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="author-info"><div class="author-info__avatar text-center"><img src="/images/avatar.jpg"></div><div class="author-info__name text-center">feng</div><div class="author-info__description text-center">feng's blog</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">31</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">11</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">3</span></a></div></div></div><nav id="nav" style="background-image: url(https://sotama.cool/picture)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">冯京哲的狗窝</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="site-info"><div id="site-title">冯京哲的狗窝</div><div id="site-sub-title">Make noise since 1997.</div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2017/04/15/23/">AS编写自己的库</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2017-04-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/配置/">配置</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/android/">android</a></span><div class="content"><h2 id="1-编写android-library"><a href="#1-编写android-library" class="headerlink" title="1.编写android library"></a>1.编写android library</h2><p>除了我们熟知的jar包外，android还支持另外一种打包——aar包，它与jar包不同之处在于它可以把资源文件一起打包，而jar包只打包源代码。</p>
<p>1.点击file-&gt;new-&gt;new module-&gt;android library，发现我们的项目下多了一个文件，gradle脚本也多了一个文件。</p>
<p><img src="/images/23/project.png" alt="project"></p>
<p>实质上我们的android library是以新的module的形式创建的，它与原本项目的app module是一样的，唯一不同之处在于它的module的gradle文件的第一行是</p>
<p><code>apply plugin: &#39;com.android.library&#39;</code></p>
<p>这样以后在项目build后会在它的build文件夹下生成aar文件而不是apk文件。</p>
<p>打开project的gradle文件，include的module从原来的app变成了app和mylibrary，说明我们确实给项目增加了module。</p>
<p><code>include &#39;:app&#39;, &#39;:mylibrary&#39;</code></p>
<p>如果我们想删除这个库，直接从project的gradle文件中删除它的module就可以了，剩下的移除工作全由AS解决。</p>
<p>2.编写完android库后，回到app module中却发现写的库并不可用，原因是app module并没有引入库module。</p>
<p>点击file-&gt;project structure-&gt;app-&gt;dependencies-&gt;add-&gt;3.module dependencies-&gt;mylibrary就可以把库module添加到app module的依赖中去了。</p>
<p>app module的gradle文件中多了这么一行</p>
<p><code>compile project(&quot;:mylibrary&quot;)</code></p>
<p>3.如果在别的项目中想要使用库，有两种办法</p>
<p>①引入module。好处在于可以更改库中的文件，更加灵活。点击file-&gt;new-&gt;import module选择要引入的module，重复2的操作在app module中引入依赖。</p>
<p>②引入aar包。我们将库所在文件夹的build文件里找到aar包，复制到要使用库的项目的libs文件夹下，按照先前的经验，接下来应该在app module的gradle文件中增加aar依赖。</p>
<p><code>compile(name:&#39;mylibrary&#39;, ext:&#39;aar&#39;)</code></p>
<p>之后的思路也很明确，AS如何能找到mylibrary文件呢，libs只是一个普通文件夹而已，并没有环境变量定义它的路径，办法是给app module增加一个仓库，仓库地址就是libs文件夹。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">repositories &#123;</span><br><span class="line">    flatDir &#123;</span><br><span class="line">        dirs &apos;libs&apos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>OK，可以愉快地在项目中使用我们自己编写的android库啦~</p>
<h2 id="2-创建自己的gradle依赖包"><a href="#2-创建自己的gradle依赖包" class="headerlink" title="2.创建自己的gradle依赖包"></a>2.创建自己的gradle依赖包</h2><p>参考：<a href="https://blog.csdn.net/tgbus18990140382/article/details/53066865" target="_blank" rel="noopener">Android创建自己的gradle依赖包</a></p>
<p>首先这里需要用到两个网站：</p>
<p>1.github</p>
<p>2.jitpack</p>
<p>具体步骤</p>
<p>1.在AS创建好我们的android library后，使用AS自带的VCS插件关联到github仓库（自己创建仓库也没关系）。</p>
<p>2.在github中发布release版本，进入jitpack，生成依赖包。</p>
<p>3.在项目中加入gradle依赖。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2017/04/07/22/">RecyclerView学习笔记</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2017-04-07</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/技术/">技术</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/android/">android</a></span><div class="content"><p>以前在做app时，我习惯使用ListView、GridView等控件来实现列表、网格展示数据的效果。今天研究b站客户端源码的时候，稍微了解了一下RecyclerView控件，它可以用来替代以往的ListView和GridView，并且对上拉刷新和下拉加载功能有很方便的回调，此外添加删除操作也有特殊的动效，而且结合前面所学的Design Library，CoordinatorLayout对它有很好的支持，看来很值得学习一下它。</p>
<p>学习参考：<a href="https://blog.csdn.net/developer_jiangqq/article/details/49927631" target="_blank" rel="noopener">【FastDev4Android框架开发】RecyclerView完全解析,让你从此爱上它(二十八)</a></p>
<p><a href="https://blog.csdn.net/developer_jiangqq/article/details/49992269" target="_blank" rel="noopener">【FastDev4Android框架开发】RecyclerView完全解析之下拉刷新与上拉加载SwipeRefreshLayout(三十一)</a></p></div><a class="more" href="/2017/04/07/22/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2017/04/04/21/">Android Design Support Library（材料设计兼容库）学习</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2017-04-04</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/技术/">技术</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/android/">android</a></span><div class="content"><p>android5.0引入了Material Design，后续发布的android design support library直接兼容到了android2.1，现在越来越多的App开始使用它的组件，这将是未来App的主流设计风格。</p>
<p>引入项目</p>
<p><code>compile &#39;com.android.support:design:24.2.0&#39;</code></p></div><a class="more" href="/2017/04/04/21/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2017/03/26/20/">android Toolbar学习笔记</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2017-03-26</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/技术/">技术</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/android/">android</a></span><div class="content"><p>学习Toolbar之前，需要了解Toolbar与ActionBar之间的区别。这里贴上官方文档对Toolbar的解释。</p>
<blockquote>
<p>A Toolbar is a generalization of action bars for use within application layouts. While an action bar is traditionally part of an Activity’s opaque window decor controlled by the framework, a Toolbar may be placed at any arbitrary level of nesting within a view hierarchy. An application may choose to designate a Toolbar as the action bar for an Activity using the setSupportActionBar() method.</p>
</blockquote>
<p>简单翻译一下，Toolbar是ActionBar的更一般化，他可以存在于一个view的任何层次，我们可以给Activity定制一个Toolbar用于取代ActionBar。</p>
<p>究其历史原因，Android3.0推了ActionBar这个控件，而到了2013年Google开始大力地推动所谓的android style，想要逐渐改善过去纷乱的界面设计，希望让终端使用者尽可能在android手机有个一致的操作体验，Toolbar的出现意味着官方在某些程度上认为ActionBar限制了开发与设计的弹性。</p>
<p>（2018/5/10修订：Activity不带ActionBar，可以给它添加ActionBar而不能给它添加Toolbar，这里的添加是指代码中setSupportActionBar，而不是布局文件中添加，如果强行在布局文件中添加，menu不会显示。AppCompatActivity带ActionBar，也可以给它添加Toolbar，如果AppCompatActivity不隐藏ActionBar而添加Toolbar，会报运行时异常）<br>由于Activity是自带ActionBar的，所以想要使用Toolbar，先得将ActionBar隐藏起来。我们可以在style.xml中更改Activity的Theme，加入下面两行代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;item name=&quot;windowNoTitle&quot;&gt;true&lt;/item&gt;</span><br><span class="line">&lt;item name=&quot;windowActionBar&quot;&gt;false&lt;/item&gt;</span><br></pre></td></tr></table></figure>
<p>或者更方便的，我们让Theme的parent为Theme.AppCompat.Light.NoActionBar</p>
<p>接着在Activity的Layout里面加入我们Toolbar的xml文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.v7.widget.Toolbar xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">         android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">         android:layout_width=&quot;match_parent&quot;</span><br><span class="line">         android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">         &lt;!-- 当ToolBar没有添加任何东西时给其一个最小高度 --&gt;</span><br><span class="line">         android:minHeight=&quot;?attr/actionBarSize&quot;</span><br><span class="line">         android:background=&quot;?attr/colorPrimary&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;/android.support.v7.widget.Toolbar&gt;</span><br></pre></td></tr></table></figure>
<p>现在来看看效果，Toolbar已经成功显示了。</p>
<p><img src="/images/20/toolbar1.png" alt="toolbar"></p>
<p>得到了Toolbar以后，我们接下来研究如何给Toolbar自定义颜色和增加控件。</p></div><a class="more" href="/2017/03/26/20/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2017/03/25/19/">android LayoutInflater学习笔记</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2017-03-25</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/技术/">技术</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/android/">android</a></span><div class="content"><h2 id="获取LayoutInflater"><a href="#获取LayoutInflater" class="headerlink" title="获取LayoutInflater"></a>获取LayoutInflater</h2><p>有三种方法获取LayoutInflater，分别是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LayoutInflater inflater = LayoutInflater.from(context);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LayoutInflater inflater = getLayoutInflater();//在activity中使用</span><br></pre></td></tr></table></figure>
<p>而后两种方法实际也是调用第一种方法，得到的是LayoutInflater的实现类PhoneLayoutInflater。</p>
<h2 id="inflate方法"><a href="#inflate方法" class="headerlink" title="inflate方法"></a>inflate方法</h2><p>在生成view的时候常常要使用inflate方法，在fragment的onCreateView方法中我习惯写</p>
<p><code>View view = inflater.inflate(R.layout.xxx, container, false);</code></p>
<p>在listview adapter的getView方法中我又习惯写</p>
<p><code>View view = inflater.inflate(R.layout.xxx, null);</code></p>
<p>而却完全不明白这两个重载之间的区别。实际上inflate方法有四个重载而前三个方法本质也是调用最后一个方法。</p>
<p><img src="/images/19/inflate.png" alt="inflate"></p>
<p>那么回到上面的两个例子，它们究竟有什么不同呢。通过下面这个例子解释一下。</p>
<p>布局文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;TextView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    android:text=&quot;hello world&quot;</span><br><span class="line">    android:background=&quot;@android:color/darker_gray&quot;</span><br><span class="line">    android:gravity=&quot;center&quot;/&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;Button</span><br><span class="line">       android:id=&quot;@+id/btn&quot;</span><br><span class="line">       android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">       android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">       android:text=&quot;加载布局&quot;/&gt;</span><br><span class="line"></span><br><span class="line">   &lt;LinearLayout</span><br><span class="line">       android:id=&quot;@+id/root&quot;</span><br><span class="line">       android:orientation=&quot;vertical&quot;</span><br><span class="line">       android:layout_width=&quot;300dp&quot;</span><br><span class="line">       android:layout_height=&quot;300dp&quot;&gt;</span><br><span class="line">   &lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure>
<p>MainActivity</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">final LinearLayout root = (LinearLayout) findViewById(R.id.root);</span><br><span class="line">        Button btn = (Button) findViewById(R.id.btn);</span><br><span class="line">        btn.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">                LayoutInflater inflater = getLayoutInflater();</span><br><span class="line">                View view = inflater.inflate(R.layout.item, null);</span><br><span class="line">                root.addView(view);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<p>我们给ViewGroup传null，运行结果如下</p>
<p><img src="/images/19/ViewGroup_null.png" alt="ViewGroup_null"></p>
<p>发现我们给textview设定的match_parent属性并没有生效（毕竟它没有parent）。这就是第二个参数的作用所在，给生成的view限定一个parent，修改代码如下</p>
<p><code>View view = inflater.inflate(R.layout.item, root, true);</code></p>
<p>运行结果则让人满意</p>
<p><img src="/images/19/ViewGroup_root.png" alt="ViewGroup_root"></p>
<p>另外第三个Boolean参数的作用是决定是否将view加入parent的xml文档结构里去，默认为true，当为false时，parent只作为参照决定view的位置和大小，而不把view加入它的xml文档里去，当然，这样的话它不存在与文档结构中，所以也不会显示出来。</p>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://sotama.cool/picture)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2019 By feng</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>
<!DOCTYPE html>
<html>

<head>
  
  <title>android Toolbar学习笔记 - 冯京哲的狗窝</title>
  <meta charset="UTF-8">
  <meta name="description" content="feng&#39;s blog">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  

  <link rel="shortcut icon" href="/favicon.ico" type="image/png" />
  <meta name="description" content="学习Toolbar之前，需要了解Toolbar与ActionBar之间的区别。这里贴上官方文档对Toolbar的解释。  A Toolbar is a generalization of action bars for use within application layouts. While an action bar is traditionally part of an Activity’s">
<meta name="keywords" content="android">
<meta property="og:type" content="article">
<meta property="og:title" content="android Toolbar学习笔记">
<meta property="og:url" content="http://www.fengjingzhe.com/2017/03/26/android Toolbar学习笔记/index.html">
<meta property="og:site_name" content="冯京哲的狗窝">
<meta property="og:description" content="学习Toolbar之前，需要了解Toolbar与ActionBar之间的区别。这里贴上官方文档对Toolbar的解释。  A Toolbar is a generalization of action bars for use within application layouts. While an action bar is traditionally part of an Activity’s">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://www.fengjingzhe.com/images/20/toolbar1.png">
<meta property="og:image" content="http://www.fengjingzhe.com/images/20/toolbar_color.png">
<meta property="og:image" content="http://www.fengjingzhe.com/images/20/widget.png">
<meta property="og:image" content="http://www.fengjingzhe.com/images/20/toolbar2.png">
<meta property="og:image" content="http://www.fengjingzhe.com/images/20/toolbar3.png">
<meta property="og:updated_time" content="2019-05-17T16:21:42.631Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="android Toolbar学习笔记">
<meta name="twitter:description" content="学习Toolbar之前，需要了解Toolbar与ActionBar之间的区别。这里贴上官方文档对Toolbar的解释。  A Toolbar is a generalization of action bars for use within application layouts. While an action bar is traditionally part of an Activity’s">
<meta name="twitter:image" content="http://www.fengjingzhe.com/images/20/toolbar1.png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/css/mdui.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.15.8/styles/atom-one-dark.css">
   
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1038733_0xvrvpg9c0r.css">
  <link rel="stylesheet" href="/css/style.css?v=1573583250616">
</head>

<body class="mdui-drawer-body-left">
  
  <div id="nexmoe-background">
    <div class="nexmoe-bg" style="background-image: url(/images/bg.jpg)"></div>
    <div class="mdui-appbar mdui-shadow-0">
      <div class="mdui-toolbar">
        <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">menu</i></a>
        <div class="mdui-toolbar-spacer"></div>
        <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
        <a href="/" title="feng" class="mdui-btn mdui-btn-icon"><img src="/images/avatar.jpg"></a>
       </div>
    </div>
  </div>
  <div id="nexmoe-header">
      <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="feng">
            <img src="/images/avatar.jpg" alt="feng">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>31</div>
        <div><span>标签</span>11</div>
        <div><span>分类</span>3</div>
    </div>
    <ul class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/archives" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/about" title="关于博客">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博客
            </div>
        </a>
        
    </ul>
    <aside id="nexmoe-sidebar">
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">社交按钮</h3>
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://space.bilibili.com/7822981" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/fjz97/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><span class="category-list-count">25</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/配置/">配置</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">标签云</h3>
    <div class="nexmoe-widget tagcloud">
      <a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/android/" style="font-size: 20px;">android</a> <a href="/tags/j2ee/" style="font-size: 14px;">j2ee</a> <a href="/tags/jQuery/" style="font-size: 16px;">jQuery</a> <a href="/tags/java/" style="font-size: 18px;">java</a> <a href="/tags/javascript/" style="font-size: 12px;">javascript</a> <a href="/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/随笔/" style="font-size: 10px;">随笔</a>
    </div>
  </div>

  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li></ul>
    </div>
  </div>


  
</aside>
    <div class="nexmoe-copyright">
        &copy; 2019 feng
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://nexmoe.com/hexo-theme-nexmoe.html" target="_blank">Nexmoe</a>
    </div>
</div><!-- .nexmoe-drawer -->
  </div>
  <div id="nexmoe-content">
    <div class="nexmoe-primary">
        <div class="nexmoe-post">
    <div class="nexmoe-post-cover"> 
        
            <img src="/images/bg.jpg">
        
        <h1>android Toolbar学习笔记</h1>
    </div>
  <div class="nexmoe-post-meta">
    <a><i class="nexmoefont icon-calendar-fill"></i>2017年03月26日</a>
    <a><i class="nexmoefont icon-areachart"></i>1.6k 字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>大概 8 分钟</a>
    
      <a class="nexmoefont icon-appstore-fill -link" href="/categories/技术/">技术</a>
    
    
      <a class="nexmoefont icon-tag-fill -link" href="/tags/android/">android</a>
    
  </div>
  <article>
    <p>学习Toolbar之前，需要了解Toolbar与ActionBar之间的区别。这里贴上官方文档对Toolbar的解释。</p>
<blockquote>
<p>A Toolbar is a generalization of action bars for use within application layouts. While an action bar is traditionally part of an Activity’s opaque window decor controlled by the framework, a Toolbar may be placed at any arbitrary level of nesting within a view hierarchy. An application may choose to designate a Toolbar as the action bar for an Activity using the setSupportActionBar() method.</p>
</blockquote>
<p>简单翻译一下，Toolbar是ActionBar的更一般化，他可以存在于一个view的任何层次，我们可以给Activity定制一个Toolbar用于取代ActionBar。</p>
<p>究其历史原因，Android3.0推了ActionBar这个控件，而到了2013年Google开始大力地推动所谓的android style，想要逐渐改善过去纷乱的界面设计，希望让终端使用者尽可能在android手机有个一致的操作体验，Toolbar的出现意味着官方在某些程度上认为ActionBar限制了开发与设计的弹性。</p>
<p>（2018/5/10修订：Activity不带ActionBar，可以给它添加ActionBar而不能给它添加Toolbar，这里的添加是指代码中setSupportActionBar，而不是布局文件中添加，如果强行在布局文件中添加，menu不会显示。AppCompatActivity带ActionBar，也可以给它添加Toolbar，如果AppCompatActivity不隐藏ActionBar而添加Toolbar，会报运行时异常）<br>由于Activity是自带ActionBar的，所以想要使用Toolbar，先得将ActionBar隐藏起来。我们可以在style.xml中更改Activity的Theme，加入下面两行代码。</p>
<pre><code>        &lt;item name=&quot;windowNoTitle&quot;&gt;true&lt;/item&gt;
        &lt;item name=&quot;windowActionBar&quot;&gt;false&lt;/item&gt;
</code></pre><p>或者更方便的，我们让Theme的parent为Theme.AppCompat.Light.NoActionBar</p>
<p>接着在Activity的Layout里面加入我们Toolbar的xml文件。</p>
<pre><code>&lt;android.support.v7.widget.Toolbar xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
         android:id=&quot;@+id/toolbar&quot;
         android:layout_width=&quot;match_parent&quot;
         android:layout_height=&quot;wrap_content&quot;
         &lt;!-- 当ToolBar没有添加任何东西时给其一个最小高度 --&gt;
         android:minHeight=&quot;?attr/actionBarSize&quot;
         android:background=&quot;?attr/colorPrimary&quot;&gt;

&lt;/android.support.v7.widget.Toolbar&gt;
</code></pre><p>现在来看看效果，Toolbar已经成功显示了。</p>
<p><img src="/images/20/toolbar1.png" alt="toolbar"></p>
<p>得到了Toolbar以后，我们接下来研究如何给Toolbar自定义颜色和增加控件。</p>
<a id="more"></a>
<h2 id="1-自定义颜色"><a href="#1-自定义颜色" class="headerlink" title="1.自定义颜色"></a>1.自定义颜色</h2><p>通过这张图片，我们来了解一下颜色的修改。</p>
<p><img src="/images/20/toolbar_color.png" alt="toolbar_color"></p>
<p>1.状态栏底色：通过在Theme里设定colorPrimaryDark</p>
<p>2.ToolBar底色：通过在Toolbar控件里设置background属性（如果是ActionBar，则在Theme里设定colorPrimary，我们往往设定ToolBar的时候沿用这个属性）</p>
<p>3.导航栏底色：通过在Theme（v21）里设定android:navigationBarColor属性</p>
<p>4.windowBackground：通过在Theme里设定android:windowBackground属性</p>
<h2 id="2-控件"><a href="#2-控件" class="headerlink" title="2.控件"></a>2.控件</h2><p>查阅官方文档，Toolbar提供了这些控件。</p>
<blockquote>
<ul>
<li>A navigation button. This may be an Up arrow, navigation menu toggle, close, collapse, done or another glyph of the app’s choosing. This button should always be used to access other navigational destinations within the container of the Toolbar and its signified content or otherwise leave the current context signified by the Toolbar. The navigation button is vertically aligned within the Toolbar’s minimum height, if set.</li>
<li>A branded logo image. This may extend to the height of the bar and can be arbitrarily wide.</li>
<li>A title and subtitle. The title should be a signpost for the Toolbar’s current position in the navigation hierarchy and the content contained there. The subtitle, if present should indicate any extended information about the current content. If an app uses a logo image it should strongly consider omitting a title and subtitle.</li>
<li>One or more custom views. The application may add arbitrary child views to the Toolbar. They will appear at this position within the layout. If a child view’s Toolbar.LayoutParams indicates a Gravity value of CENTER_HORIZONTAL the view will attempt to center within the available space remaining in the Toolbar after all other elements have been measured.</li>
<li>An action menu. The menu of actions will pin to the end of the Toolbar offering a few frequent, important or typical actions along with an optional overflow menu for additional actions. Action buttons are vertically aligned within the Toolbar’s minimum height, if set.</li>
</ul>
</blockquote>
<p>结合这张图，对这些控件的布局应该就一目了然了，下面上Demo。</p>
<p><img src="/images/20/widget.png" alt="widget"></p>
<p>首先获取到Toolbar并通过setSupportActionBar方法给Activity设置Toolbar。</p>
<pre><code>        Toolbar mToolbar = (Toolbar) findViewById(R.id.toolbar);
        setSupportActionBar(mToolbar);
</code></pre><p>对上图1234的设置比较简单，直接按照上述方法进行设置。</p>
<pre><code>        mToolbar.setTitle(&quot;Demo&quot;);
        mToolbar.setSubtitle(&quot;jzfeng&quot;);
        mToolbar.setLogo(R.drawable.icon);
        mToolbar.setNavigationIcon(R.drawable.icon);
        mToolbar.setNavigationOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                MainActivity.this.finish();
            }
        });
</code></pre><p>而对于菜单的设置，Toolbar与ActionBar并无差异，同样是在res/menu下写菜单文件xml，然后在Activity的onCreateOptionsMenu中inflate菜单view。</p>
<pre><code>&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
      xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
      xmlns:tools=&quot;http://schemas.android.com/tools&quot;
      tools:context=&quot;.MainActivity&quot;&gt;
    &lt;item
        android:id=&quot;@+id/action_settings&quot;
        android:title=&quot;设置&quot;
        app:showAsAction=&quot;never&quot;/&gt;

    &lt;item
        android:id=&quot;@+id/action_test&quot;
        android:title=&quot;测试&quot;
        android:icon=&quot;@drawable/icon&quot;
        app:showAsAction=&quot;ifRoom&quot;/&gt;
&lt;/menu&gt;
</code></pre><pre><code>        mToolbar.setOnMenuItemClickListener(new Toolbar.OnMenuItemClickListener() {
            @Override
            public boolean onMenuItemClick(MenuItem item) {
                if(item.getItemId() == R.id.action_settings) {
                    Toast.makeText(MainActivity.this, &quot;settings clicked&quot;, Toast.LENGTH_SHORT).show();
                } else if(item.getItemId() == R.id.action_test) {
                    Toast.makeText(MainActivity.this, &quot;test clicked&quot;, Toast.LENGTH_SHORT).show();
                }
                return true;
            }
        });
</code></pre><pre><code>    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.menu, menu);
        return true;
    }
</code></pre><p>注意listener的设定必须写在setSupportActionBar方法之后，否则不起效，另外，optionsMenu点击事件也会回调到Activity的onOptionsItemSelected方法中，所以写在那里也没问题。</p>
<p>现在看看效果吧。</p>
<p><img src="/images/20/toolbar2.png" alt="toolbar"></p>
<p>哇，丑爆了。。。事实上，我们这种做法确实完全没有发挥出Toolbar的真实威力。Toolbar既然存在于布局文件中，那么我们当然可以在布局文件中直接给它添加view。</p>
<h2 id="3-添加子View"><a href="#3-添加子View" class="headerlink" title="3.添加子View"></a>3.添加子View</h2><p>明白了该怎这么做，我直接附上代码。</p>
<pre><code>&lt;android.support.v7.widget.Toolbar xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
         android:id=&quot;@+id/toolbar&quot;
         android:layout_width=&quot;match_parent&quot;
         android:layout_height=&quot;wrap_content&quot;
         android:minHeight=&quot;?attr/actionBarSize&quot;
         android:background=&quot;?attr/colorPrimary&quot;&gt;

    &lt;ImageView
        android:id=&quot;@+id/nav_icon&quot;
        android:layout_width=&quot;30dp&quot;
        android:layout_height=&quot;30dp&quot;
        android:layout_margin=&quot;3dp&quot;
        android:src=&quot;@drawable/icon&quot;/&gt;

    &lt;ImageView
        android:id=&quot;@+id/logo&quot;
        android:layout_width=&quot;50dp&quot;
        android:layout_height=&quot;50dp&quot;
        android:layout_marginLeft=&quot;20dp&quot;
        android:src=&quot;@drawable/icon&quot;/&gt;

    &lt;LinearLayout
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;match_parent&quot;
        android:orientation=&quot;vertical&quot;&gt;

        &lt;TextView
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;25dp&quot;
            android:textSize=&quot;20sp&quot;
            android:text=&quot;Demo&quot;/&gt;

        &lt;TextView
            android:layout_marginTop=&quot;3dp&quot;
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;20dp&quot;
            android:textSize=&quot;14sp&quot;
            android:text=&quot;jzfeng&quot;/&gt;

    &lt;/LinearLayout&gt;

&lt;/android.support.v7.widget.Toolbar&gt;
</code></pre><pre><code>        getSupportActionBar().setDisplayShowTitleEnabled(false);
        mToolbar.findViewById(R.id.nav_icon).setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                MainActivity.this.finish();
            }
        });
</code></pre><p>注意这里要使用getSupportActionBar().setDisplayShowTitleEnabled(false)使Toolbar不再默认显示标题。这之后我们就可以想获取到哪个View就获取到哪个View，想进行什么操作就进行什么操作了。最后附上完成图~</p>
<p><img src="/images/20/toolbar3.png" alt="toolbar"></p>

  </article>
  
    
<div class="nexmoe-post-copyright">
<i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
<strong>本文作者：</strong>feng<br>
<strong>本文链接：</strong><a href="http://www.fengjingzhe.com/2017/03/26/android Toolbar学习笔记/" title="http://www.fengjingzhe.com/2017/03/26/android Toolbar学习笔记/" target="_blank" rel="noopener">http://www.fengjingzhe.com/2017/03/26/android Toolbar学习笔记/</a><br>

  <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可

</div>


  
  <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.5.0/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@1.5.0/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '80b2453b6d5f37ad6225',
        clientSecret: '43e99fa852795c9a7b3eb924b2558c64b84bbdeb',
        id: window.location.pathname,
        repo: 'nexmoe.github.io',
        owner: 'nexmoe',
        admin: 'nexmoe'
    })
    gitalk.render('gitalk')
</script>
</section>
</div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/js/mdui.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
 
    <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>


 
    <script src="https://cdn.jsdelivr.net/npm/smoothscroll-for-websites@1.4.9/SmoothScroll.min.js"></script>


<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.8/build/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="/js/app.js?v=1573583250631"></script>
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.1.0/lazysizes.min.js"></script>

  





</body>

</html>
